---
title: vim编辑器
date: 2025-02-25 13:01:43
tags:
categories: Linux
---

# vim编辑器

vim是一个全屏幕纯文本编辑器，是vi编辑器的增强版。

可以利用别名让输入vi命令的时候，实际上执行vim编辑器，如：

```shell
# 定义别名
alias vi='vim'
```

这样定义的别名是临时生效，如果需要永久生效，需要放入环境变量配置文件(~/.bashrc)。



## 1. vim工作模式

### 1）命令模式

主要使用快捷键的模式。

命令模式想要进入输入模式，可以使用以下方式：

| 命令 | 作用                 |
| ---- | -------------------- |
| a    | 在光标所在字符后插入 |
| A    | 在光标所在行尾插入   |
| i    | 在光标所在字符前插入 |
| I    | 在光标所在行行首插入 |
| o    | 在光标下插入新行     |
| O    | 在光标上插入新行     |
| ZZ   | 保存退出             |



### 2）输入模式

主要用于文本编辑，和记事本类似，输入数据就好。



### 3）编辑模式(末行模式)

| 命令        | 作用                                                         |
| ----------- | ------------------------------------------------------------ |
| :w          | 保存不退出                                                   |
| :w 新文件名 | 把文件另存为新文件                                           |
| :q          | 不保存退出                                                   |
| :wq         | 保存退出                                                     |
| :!          | 强制                                                         |
| :q!         | 强制不保存退出，用于修改文件之后，不保存数据退出             |
| :wq!        | 强制保存退出，当文件的所有者或者root用户，对文件没有写权限的时候，强制写入数据使用 |



## 2. 命令模式操作

### 1）移动光标

| 功能             | 快捷键                                         |
| ---------------- | ---------------------------------------------- |
| 上下左右移动光标 | 上、下、左、右方向键或者k、j、h、l             |
| 移动到文件头     | gg                                             |
| 移动到文件尾     | G或者shift+g                                   |
| 移动到行首       | ^                                              |
| 移动到行尾       | $                                              |
| 移动到指定行     | :n(这里n是数字，准备移动到第几行，就用哪个数字 |

### 2）删除或剪切

| 功能                     | 快捷键  |
| ------------------------ | ------- |
| 删除单个字母             | x       |
| 删除n个字母              | nx      |
| 删除单行                 | dd      |
| 删除多行                 | ndd     |
| 删除指定范围的行         | :n1,n2d |
| 粘贴到光标后             | p       |
| 粘贴到光标前             | P(大)   |
| 从光标所在行删除到文件尾 | dG      |

删除整行或多行，这是比较常用的删除方法，这里的dd快捷键既是删除，也是剪切。删除内容放入了剪切板，如果不粘贴就是剪切。

### 3）复制

| 功能     | 快捷键 |
| -------- | ------ |
| 复制单行 | yy     |
| 复制多行 | nyy    |

### 4）撤销

| 功能   | 快捷键 |
| ------ | ------ |
| 撤销   | u      |
| 反撤销 | ctrl+r |

u键能一直撤销到文件打开时的状态，类似Windows下ctrl+z键的作用。

ctrl+z能一直反撤销到最后一次操作状态，类似Windows下ctrl+y键的作用。

### 5）vim配置文件

这些末行模式参数设置，多数需要在vim中才能生效。

| 设置参数        | 含义                                                         |
| --------------- | ------------------------------------------------------------ |
| :set nu         | 显示行号                                                     |
| :set nonu       | 取消行号                                                     |
| :syntax on      | 依据语法显示相关的颜色帮助                                   |
| :syntax off     | 不显示语法相关的颜色帮助                                     |
| :set hlsearch   | 设置将查找的字符串高亮显示，默认是set hlsearch高亮显示       |
| :set nohlsearch | 取消将查找的字符串高亮显示                                   |
| :set ruler      | 设置显示右下角的状态栏                                       |
| :set noruler    | 取消显示右下角的状态栏                                       |
| :set showmode   | 设置在左下角显示如“--INSERT--”之类的状态栏，默认是set showmode显示 |
| :set noshowmode | 取消在左下角显示如"--INSERT--"之类的状态栏                   |
| :set list       | 设置显示隐藏字符(Tab键用"I"表示，回车符用“$”表示)            |
| :set nolist     | 设置不显示隐藏字符，默认是nolist                             |
| :set all        | 查看所有设置参数                                             |

大家会发现，这些设置参数都只是临时生效，一旦关闭文件再打开，又需要重新输入。如果想要永久生效，需要手工建立vim的配置文件"~/.vimrc"，把你需要的参数写入配置文件就永久生效了。

Windows下回车符在Linux中是用“^M$”符号显示，而不是"$"符。这样会导致Windows下编辑的程序脚本，无法在Linux中执行。这时可以通过命令"dos2unix"，把Windows格式转为Linux格式，当然反过来"unix2dos"命令就是把Linux格式转为Windows格式。这两个命令默认没有安装，需要手工安装才能使用。

### 6）查找

| 命令      | 作用                 |
| --------- | -------------------- |
| /查找内容 | 从光标所在行向下查找 |
| ?查找内容 | 从光标所在行向上查找 |
| n         | 下一个               |
| N         | 上一个               |

### 7）替换

| 命令             | 作用                                |
| ---------------- | ----------------------------------- |
| r                | 替换光标所在处的字符                |
| R                | 从光标所在处开始替换字符，按ESC结束 |
| :1,10s/old/new/g | 替换1到10行的所有old为new           |
| :%s/old/new/g    | 替换整个文件的old为new              |

示例

```
# 在shell中“#”开头是注释，批量注释1到10行
:1,10s/^/#/g

# 取消注释
:1,10s/^#//g

# 批量添加“//”注释
:1,10s/^/\/\//g

# 取消注释
:1,10s/^\/\///g
```



## 3. vim使用技巧

### 1）在vim中导入其他文件内容或命令结果

a）导入其他文件内容

```
# 把文件内容导入光标下一行
:r 文件名            
```

可以把其他文件的内容导入到光标下一行位置。



b）在vim中执行系统命令

```
# 在vim中执行系统命令
:!命令
```

这里只是在vim中执行系统命令，但并不把系统命令的结果写入到文件中，主要用于在文件编辑中，查看系统信息如时间。



c）导入命令结果

```
# 在vim中执行系统命令，并把命令结果导入光标下一行
:r !命令
```



### 2）设定快捷键

```
# 自定义快捷键
:map 快捷键 快捷键执行的命令
```

示例

```
# 按ctrl+p时，在行首加入注释
:map ^P I#<ESC>

# 按ctrl+b时，删除行首第一个字母
:map ^B ^x
```

**注意**：^P快捷键不能手工输入，需要执行ctrl+V+P来定义，或ctrl+v，然后ctrl+p。



### 3）字符替换

```
# 字符替换
:ab 源字符 替换为字符
```

在vim编辑中，有时候需要频繁输入某一长字符串(比如邮箱)，这时使用字符串替换，能增加输入效率。

```
# 当碰到“mymail”时，转变为邮箱
:ab mymail ben@163.com
```

**注意：**“源字符”不应设置的太短，否则有可能影响输入。



### 4）多文件打开

```
# vim上下分屏同时打开两个文件
vim -o 文件1 文件2

# vim左右分屏同时打开两个文件
vim -O 文件1 文件2
```

这样可以同时打开两个文件，方便操作。可以通过先按"ctrl+w"，再按方向键的方式在两个文件之间切换。

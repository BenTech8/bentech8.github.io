---
title: Linux常用命令
date: 2025-02-25 12:58:15
tags:
categories: Linux
---

# Linux常用命令

## 1. 命令提示符

```
ben@ben-NBLK-WAX9X:~$
```

- []：这是提示符的分隔符号，没有特殊含义
- ben：显示的是当前的登录用户。
- @：分隔符号，没有特殊含义。
- ben-NBLK-WAX9X：当前系统的简写主机名。
- ~：代表用户当前所在的目录。
- $：命令提示符，超级用户是#，普通用户是$。



## 2. 文件操作命令

### 1）touch

创建空文件或者修改文件时间。



### 2）stat

查看文件详细信息，而且可以看到文件的四个时间。

```
stat abc
文件：abc
  大小：0         	块：0          IO 块大小：4096   普通空文件
设备：259,10	Inode: 2953378     硬链接：1
权限：(0664/-rw-rw-r--)  Uid: ( 1000/     ben)   Gid: ( 1000/     ben)
访问时间：2024-11-19 16:04:02.421884754 +0800      # 最后一次访问时间
修改时间：2024-11-19 16:04:02.421884754 +0800      # 数据修改时间
变更时间：2024-11-19 16:04:02.421884754 +0800      # 状态修改时间
创建时间：2024-11-19 16:03:01.150885757 +0800
```



### 3）cat

【功能描述】：查看文件内容。

选项：

- -A：相当于-vET选项的整合，用于列出所有隐藏符号
- -E：列出每行结尾的回车符$
- -n：显示行号
- -T：把Tab键用^T显示出来
- -v：列出特殊字符



### 4）more

【功能描述】：分屏显示文件内容。

more命令比较简单，一般不用什么选项，命令会打开一个交互界面，可以识别一些交互命令。常用交互命令如下：

- 空格键：向下翻页
- b：向上翻页
- 回车键：向下滚动一行
- /字符串：指定搜索的字符串
- q：退出



### 5）less

【功能描述】：分行显示文件内容。



### 6）head

【功能描述】：显示文件开头的命令。



### 7）tail

【功能描述】：显示文件结尾的命令。

选项：

- -n 行数：从文件结尾开始，显示指定行数。
- -f：监听文件的新增内容，ctrl+c退出。



### 8）ln

【功能描述】：在文件之间建立链接

#### 1）硬链接

特征：

- 源文件和硬链接文件拥有相同的Inode和Block
- 修改任意一个文件，另一个都改变
- 删除任意一个文件，另一个都能使用
- 硬链接标记不清，很难确认硬链接文件位置，不建议使用
- 硬链接不能链接目录
- 硬链接不能跨分区



#### 2）软链接

特征：

- 软链接和源文件拥有不同的Inode和Block
- 两个文件修改任意一个，另一个都改变
- 删除软链接，源文件不受影响；删除源文件，软链接不能使用
- 软链接没有实际数据，只保存源文件的Inode，不论源文件多大，软链接大小不变
- 软链接的权限是最大权限lrwxrwxrwx.，但是由于没有实际数据，最终访问时需要参考源文件权限
- 软链接可以链接目录
- 软链接可以跨分区
- 软链接特征明显，建议使用软链接



## 3. 目录和文件都能操作的命令

### 1）rm

【功能描述】：删除文件或目录

选项：

- -f：强制删除
- -i：交互删除，在删除之前会询问用户(默认)
- -r：递归删除，可以删除目录



### 2）cp

【功能描述】：复制文件和目录

选项：

- -a：相当于-dpr选项的集合。
- -d：如果源文件为软链接(硬链接无效)，则复制出的目标文件也为软链接。
- -i：询问，如果目标文件已经存在，则会询问是否覆盖。
- -p：复制后目标文件保留源文件的属性(包括所有者、所属组、权限和时间)
- -r：递归复制，用于复制目录



### 3）mv

【功能描述】：移动文件或者改名

选项：

- -f：强制覆盖，如果目标文件已经存在，则不询问，直接强制覆盖
- -i：交互移动，如果目标文件已经存在，则询问用户是否覆盖(默认)
- -v：显示详细信息



## 4. 权限

### 1）权限位含义

- 第一位代表**文件类型**。Linux不像Windows使用扩展名表示文件类型，而是使用权限位的第1位表示文件类型。虽然Linux文件的种类不像Windows中那么多，但是分类也不少，详细情况可以使用“info ls”命令查看。
  - “-”：普通文件。
  - “b”：块设备文件。
  - “c”：字符设备文件。
  - “d”：目录文件。
  - “l”：软链接文件。
  - “p”：管道符文件。
  - “s”：套接字文件。
- 第2-4位代表**文件所有者**(u)的权限
  - r：读权限
  - w：写权限
  - x：执行权限
- 第5-7位代表**文件所属组**(g)的权限
- 第8-10位代表**其他人**(o)的权限



### 2）基本权限的作用

#### a.权限含义的解释

首先，读、写、执行权限对文件和目录的作用是不同的。

权限对文件的作用

- 读(r)：对文件有读(r)权限，代表可以读取文件中的数据。如果把权限对应到命令上，那么一旦对文件有读(r)权限，就可以对文件执行cat、more、less、head、tail等文件查看命令。
- 写(w)：对文件有写(w)权限，代表可以修改文件中的数据。如果把权限对应到命令上，那么一旦对文件有写(w)权限，就可以对文件执行vim、echo等修改文件数据的命令。注意：对文件有写权限，是不能删除文件本身的，只能修改文件中的数据。如果要想删除文件，则需要对文件的上级目录有写权限。
- 执行(x)：对文件有执行(x)权限，代表文件拥有了执行权限。可以运行。在Linux中，只要文件有执行(x)权限，这个文件就是执行文件了。只是这个文件到底能不能正确执行，不仅需要执行(x)权限，还要看文件中的代码是不是正确的语言代码。对文件来说，执行(x)权限是最高权限。

权限对目录的作用

- 读(r)：对目录有读(r)权限，代表可以查看目录下的内容，也就是可以查看目录下有哪些子文件和子目录。如果把权限对应到命令上，那么一旦对目录拥有了读(r)权限，就可以在下执行ls命令，查看目录下的内容了。
- 写(w)：对目录有写(w)权限，代表可以修改目录下的数据，也就是可以在目录中新建、删除、复制、剪切子文件或目录。如果把权限对应到命令上，那么一旦对目录拥有了写(w)权限，就可以在目录下执行touch、rm、cp、mv命令。对目录来说，写(w)权限是最高权限。
- 执行(x)：目录是不能运行的，那么对目录拥有了执行(x)权限，代表可以进入目录。如果把权限对应到命令上，那么一旦对目录拥有了执行(x)权限，就可以对目录执行cd命令，进入目录。

#### b.目录的可用权限

目录的可用权限其实只有以下几个：

- 0：任何权限都不赋予。
- 5：基本的目录浏览和进入权限。
- 7：完全权限。



### 3）chmod

【功能描述】：修改文件的权限模式。

选项：

- -R：递归设置权限，也就是给子目录中的所有文件设定权限。

【注意】

- 普通用户可以修改所有者是自己的文件的权限



### 4）chown

【功能描述】：修改文件和目录的所有者和所有组。

选项：

- -R：递归设置权限，也就是给子目录中的所有文件设置权限。

【注意】

- 普通用户不能修改文件的所有者(哪怕文件属于这个普通用户)，只有超级用户才能修改所有者。



### 5）chgrp

【功能描述】：修改文件和目录的所属组。



### 6）umask

```
# 查询系统umask权限
umask
0002       # 用八进制数值表示umask权限

umask -S
u=rwx,g=rwx,o=rx      # 用字母表示文件和目录的初始权限
```



umask权限的计算方法

新建文件和目录的默认最大权限：

- 对文件来讲，新建文件的默认最大权限是666，没有执行(x)权限。这是因为执行权限对文件来讲比较危险，不能在新建文件的时候默认赋予，而必须通过用户手工赋予。
- 对目录来讲，新建目录的默认最大权限是777，这是因为对目录而言，执行(x)权限仅仅代表进入目录，所以即使建立新文件时直接默认赋予，也没有什么危险。



按照官方的标准算法，umask默认权限需要使用二进制进行逻辑与和逻辑非联合运算才可以得到正确的新建文件和目录的默认权限。这种方法既不好计算，也不好理解，不太推荐。



按照权限字母来讲解umask权限的计算方法：

- 文件的默认权限最大只能是666，而umask的值是002

  “-rw-rw-rw-” - “-------w-” = "-rw-rw-r--"

- 目录的默认权限最大可以是777，而umask的值是002

  "drwxrwxrwx" - "d-------w-" = "drwxrwxr-x"



## 5. 帮助命令

### 1）man

【功能描述】：显示联机帮助手册

man命令快捷键

| 快捷键  | 作用                                                         |
| ------- | ------------------------------------------------------------ |
| 上箭头  | 向上移动一行                                                 |
| 下箭头  | 向下移动一行                                                 |
| PgUp    | 向上翻一页                                                   |
| PgDn    | 向下翻一页                                                   |
| g       | 移动到第一页                                                 |
| G       | 移动到最后一页                                               |
| q       | 退出                                                         |
| /字符串 | 从当前页向下搜索字符串                                       |
| ?字符串 | 从当前页向上搜索字符串                                       |
| n       | 当搜索字符串时，可以使用n键找到下一个字符串                  |
| N       | 当搜索字符串时，使用N键反向查询字符串。也就是说，如果使用“/字符串”方式搜索，则N键表示向上搜索字符串；如果使用“?字符串”方式搜索，则N键表示向下搜索字符串。 |

man命令的帮助级别

| 级别 | 作用                                         |
| ---- | -------------------------------------------- |
| 1    | 普通用户可以执行的系统命令和可执行文件的帮助 |
| 2    | 内核可以调用的函数和工具的帮助               |
| 3    | C语言函数的帮助                              |
| 4    | 设备和特殊文件的帮助                         |
| 5    | 配置文件的帮助                               |
| 6    | 游戏的帮助(个人版的Linux中是有游戏的)        |
| 7    | 杂项的帮助                                   |
| 8    | 超级用户可以执行的系统命令的帮助             |
| 9    | 内核的帮助                                   |

```shell
# 查看命令拥有哪个级别的帮助
man -f 命令 或 whatis 命令

# 查看和命令相关的所有帮助
man -k 命令 或 apropos 命令
```



### 2）info

【功能描述】：一套完整资料的帮助信息

info命令快捷键

| 快捷键 | 作用                                    |
| ------ | --------------------------------------- |
| 上箭头 | 向上移动一行                            |
| 下箭头 | 向下移动一行                            |
| PgUp   | 向上翻一页                              |
| PgDn   | 向下翻一页                              |
| Tab    | 在有“*”符号的节点间进行切换             |
| 回车   | 进入有“*”符号的子页面，查看详细帮助信息 |
| u      | 进入上一层信息(回车是进入下一层信息)    |
| n      | 进入下一小节信息                        |
| p      | 进入上一小节信息                        |
| ？     | 查看帮助信息                            |
| q      | 退出info信息                            |



### 3）help(基本不用)

【功能描述】：显示Shell内置命令的帮助。

区分Shell内置命令与外部命令：type 命令。



### 4）--help

【功能描述】：man命令的信息简要版。



## 6. 搜索命令

### 1）whereis

搜索系统命令的命令。

【功能描述】：查找二进制命令、源文件和帮助文档的命令。



### 2）which

搜索系统命令的命令。

和whereis命令的区别在于：

- whereis命令可以在查找到二进制命令的同时，查找到帮助文档的位置；
- which命令在查找到二进制命令的同时，如果这个命令有别名，则还可以找到别名命令。



### 3）locate

【功能描述】：按照文件名搜索文件。

优点：按照数据库搜索，搜索速度快，消耗资源小。数据库位置/var/lib/mlocate/mlocate.db（更新数据库：updatedb）。

缺点：只能按照文件名来搜索文件，而不能执行更复杂的搜索，比如按照权限、大小、修改时间等搜索文件。



### 4）find

- 按照文件名搜索

  ```
  find 搜索路径 [选项] 搜索内容
  选项：
    -name: 按照文件名搜索
    -iname: 按照文件名搜索，不区分文件名大小写
    -inum: 按照inode号搜索
  ```

- 按照文件大小搜索

  ```
  find 搜索路径 [选项] 搜索内容
  选项：
    -size [+|-]大小: 按照指定大小搜索文件。"+"指搜索比指定大小还大的文件，"-"指搜索比指定大小还小的文件。 
  
  单位：
  - b：默认单位，如果单位为b或者不写单位，则按照512 Byte搜索
  - c：按照字节搜索
  - w：按照双字节搜索
  - k：按KB搜索
  - M：按MB搜索
  - G：按GB搜索
  ```

- 按照修改时间搜索

  Linux中的文件有访问时间(atime)、数据修改时间(mtime)、状态修改时间(ctime)等时间。

  ```
  find 搜索路径 [选项] 搜索内容
  先项：
    -atime [+|-]时间(天)：按照访问时间搜索
    -mtime [+|-]时间(天)：按照数据修改时间搜索
    -ctime [+|-]时间(天)：按照状态修改时间搜索
    
  以mtime数据修改时间为例，说明时间含义：
  - -5：代表5天内修改的文件
  - 5：代表前5~6天那一天修改的文件
  - +5：代表6天前修改的文件
  ```

- 按照权限搜索

  ```
  find 搜索路径 [选项] 搜索内容
  选项：
    -perm 权限模式：查找文件权限刚好等于"权限模式"的文件
    -perm -权限模式：查找文件权限全部包含"权限模式"的文件
    -perm +权限模式：查找文件权限包含"权限模式"的任意一个权限的文件
  ```

- 按照所有者和所属组搜索

  ```
  find 搜索路径 [选项] 搜索内容
  选项：
    -uid 用户ID：按照用户ID查找所有者是指定ID的文件
    -gid 组ID：按照用户组ID查找所属组是指定ID的文件
    -user 用户名：按照用户名查找所有者是指定用户的文件
    -group 组名：按照组名查打所属组是指定用户组的文件
    -nouser：查找没有所有者的文件
  ```

  按照所有者和所属组搜索时，“-nouser”选项比较常用，主要用于查找垃圾文件。

  只有一种情况例外，那就是外来文件。比如光盘和U盘中的文件如果是由Windows复制的，在Linux中查看就是没有所有者的文件，再比如手工源码包安装的文件，也有可能没有所有者。

- 按照文件类型搜索

  ```
  find 搜索路径 [选项] 搜索内容
  选项：
    -type d：查找目录
    -type f：查找普通文件
    -type l：查找软链接文件
  ```

- 逻辑运算符

  ```
  find 搜索路径 [选项] 搜索内容
  选项：
    -a：逻辑与(and)
    -o：逻辑或(or)
    -not(!)：逻辑非(not)
  ```

  - -a：逻辑与(and)

    find命令也支持逻辑运算符先项，其中-a代表逻辑与运算，也就是-a的两个条件都成立，find搜索的结果才成立

    ```shell
    # 在当前目录下搜索大小2KB，并且文件类型是普通文件的文件
    find . -size +2k -a -type f
    ```

  - -o：逻辑或(or)

    -o选项代表逻辑或运算，也就是-o的两个条件只要其中一个成立，find命令就可以找到结果

    ```shell
    # 在当前目录下搜索文件名要么是cangls的文件，要么是bols的文件
    find . -name cangls -o -name bols
    ```

  - -not(!)：逻辑非(not)

    -not是逻辑非，也就是取反的意思

    ```shell
    # 在当前目录下搜索文件名不是cangls文件
    find . -not -name cangls
    find . ! -name cangls
    ```

- 其他选项

  - -exec选项

    ```
    find 搜索路径 [选项] 搜索内容 -exec 命令2 {} \；
    ```

    这个选项的作用其实是把find命令的结果交由“-exec”调用的命令2来处理。"{}"就代表find命令的查找结果。

    ```shell
    find /var/log -mtime +10 -exec ls -ahl {} \;
    ```

  - -ok选项

    “-ok”选项和"-exec"选项的作用基本一致，区别在于：“-exec”的命令2会直接处理，而不询问："-ok"的命令2在处理前会先询问用户是否这样处理，在得到确认命令后，才会执行。



## 7. 补充命令

### 1）grep

grep的作用是在文件中提取和匹配符合条件的字符串行。

```
grep [选项] "搜索内容" 文件名
选项：
  -i：忽略大小写
  -n：输出行号
  -v：反向查找
  --color=auto：搜索出的关键字用颜色显示
```



find和grep区别：

- find命令用于在系统中搜索符合条件的文件名，如果需要模糊查询，则使用通配符进行匹配。搜索文件名是完全匹配的。
- grep命令用于在文件中搜索符合条件的字符串，如果需要模糊查询，则使用正则表达式进行匹配。搜索时字符串是包含匹配的。

通匹符和正则表达式的区别：

- 通配符：用于匹配文件名，完全匹配。

  | 通配符 | 作用                                                         |
  | ------ | ------------------------------------------------------------ |
  | ？     | 匹配一个任意字符                                             |
  | *      | 匹配0个或任意多个任意字符，也就是可以匹配任何内容            |
  | []     | 匹配中括号中任意一个字符。例如，[abc]代表一定匹配一个字符，或者是a，或者是b，或者是c |
  | [-]    | 匹配中括号中任意一个字符，-代表一个范围，例如，[a-z]代表匹配一个小写字母 |
  | [^]    | 逻辑非，表示匹配不是中括号内的一个字符，例如，\[^0-9]代表匹配一个不是数字的字符 |

- 正则表达式：用于匹配字符串，包含匹配。

  | 正则符 | 作用                                                         |
  | ------ | ------------------------------------------------------------ |
  | ？     | 匹配前一个字符重复0次，或1次。只能用egrep才生效              |
  | *      | 匹配前一个字符重复0次，或任意多次                            |
  | []     | 匹配中括号中任意一个字符，例如，[abc]代表一定匹配一个字符，或者是a，或者是b，或者是c |
  | [-]    | 匹配中括号中任意一个字符，-代表一个范围，例如，[a-z]代表匹配一个小写字母 |
  | [^]    | 逻辑非，表示匹配不是中括号内的一个字符，例如，\[^0-9]代表匹配一个不是数字的字符 |
  | ^      | 匹配行首                                                     |
  | $      | 匹配行尾                                                     |




### 2）管道符

命令格式：命令1 | 命令2

命令1的正确输出作为命令2的操作对象。



### 3）命令的别名

命令的别名，就是命令的小名，主要是用于照顾管理员使用习惯的。

```shell
# 查询命令别名
alias

# 设定命令别名. alias 别名=‘原命令’
alias ser='service network restart'
```

用命令定义的别名，是临时生效的，要想永久生效，需要写入环境变量配置文件~/.bashrc。

命令的执行顺序：

- 第一顺位执行用绝对路径或相对路径执行的命令。
- 第二顺位执行别名。
- 第三顺位执行bash的内部命令。
- 第四顺位执行按照$PATH环境变量定义的目录查找顺序找到的第一个命令。



### 4）常用快捷键

| 快捷键 | 作用                                                         |
| ------ | ------------------------------------------------------------ |
| Tab键  | 命令或文件补全                                               |
| ctrl+A | 把光标移动到命令行开头。如果我们输入的命令过长，想要把光标移动到命令行开头时使用。 |
| ctrl+E | 把光标移动到命令行结尾。                                     |
| ctrl+C | 强制终止当前的命令。                                         |
| ctrl+L | 清屏，相当于clear命令                                        |
| ctrl+U | 删除或剪切光标之前的命令。我输入了一行很长的命令，不用使用退格键一个一个字符的删除，使用这个快捷键会更加方便。 |
| ctrl+Y | 粘贴ctrl+U剪切的内容。                                       |
| ctrl+D | 退出当前终端                                                 |
| ctrl+Z | 暂停，并放入后台。                                           |
| ctrl+S | 暂停屏幕输出                                                 |
| ctrl+Q | 恢复屏幕输出                                                 |



## 8. 压缩和解压缩

在Linux中可以识别的常见压缩格式有十几种，比如“.zip”，“.gz”，“.bz2”，“.tar”，“.tar.gz”，“.tar.bz2”等。

### 1）“.zip”格式

“.zip”是Windows中最常见的压缩格式。Linux也可以正确识别".zip"格式，这可以方便地和Windows系统通用压缩文件。



a）压缩命令(zip)

【功能描述】：压缩文件或目录。

```shell
# 命令格式
zip [选项] 压缩包名 源文件或源目录

选项：
  -r: 压缩目录
```



b）解压缩(unzip)

【功能描述】：列表、测试和提取压缩文件中的文件。

```shell
# 命令格式
unzip [选项] 压缩包名

选项：
  -d：指定解压缩位置
```



### 2）“.gz”格式(不会打包)

“.gz”格式是Linux中最常用的压缩格式，使用gzip命令进行压缩。



a）压缩命令(gzip)

【功能描述】：压缩文件或目录。

```shell
# 命令格式
gzip [选项] 源文件

选项：
  -c：将压缩数据输出到标准输出中，可以用于保留源文件
  -d：解压缩
  -r：压缩目录（将目录下的文件进行压缩）
```



b）解压缩(gunzip)

如果要解压缩".gz"格式，那么使用"gzip -d 压缩包"和"gunzip 压缩包"命令都可以。

【功能描述】：解压缩文件或目录。



### 3）“.bz2”格式(不能压缩目录)

“.bz2”格式是Linux的另一种压缩格式，从理论上来讲，“.bz2”格式的算法更先进、压缩比更好；而".gz"格式相对来讲压缩的时间更快。



a）压缩命令(bzip2)

【功能描述】：bz2格式的压缩命令。

```shell
# bzip2命令格式
bzip2 [选项] 源文件

选项：
  -d：解压缩
  -k：压缩时，保留源文件
  -v：显示压缩的详细信息
  
# 压缩成.bz2格式
bzip2 anaconda-ks.cfg

# 保留源文件压缩
bzip2 -k install.log.syslog
```



b）解压缩（bunzip2）

“.bz2”格式可以使用"bzip2 -d 压缩包"命令来进行解压缩，也可以使用"bunzip2 压缩包"命令来进行解压缩。

【功能描述】：.bz2格式的解压缩命令。



### 4）“.tar”格式(打包不压缩)

“.tar”格式的打包和解打包都使用tar命令，区别只是选项不同。



a）打包(tar)

```shell
# tar命令格式
tar [选项] [-f 压缩包名] 源文件或目录
选项：
  -c：打包
  -f：指定压缩包的文件名。压缩包的扩展名是用来给管理员识别格式的，所以一定要正确指定扩展名
  -v：显示打包文件过程
 
tar -cvf anaconda-ks.cfg.tar anaconda-ks.cfg
```



b）解打包(tar)

```shell
# 命令格式
tar [选项] 压缩包
选项：
  -x：解打包
  -f：指定压缩包的文件名
  -v：显示解打包文件过程
  -t：测试，就是不解打包，只是查看包中有哪些文件
```



### 5）“.tar.gz”和".tar.bz2"格式

使用tar命令直接打包压缩。

```shell
# 命令格式
tar [选项] 压缩包 源文件或目录
选项：
  -z：压缩和解压缩“.tar.gz”格式
  -j：压缩和解压缩“.tar.bz2”格式

# 将/tmp目录打包压缩
tar -zcvf tmp.tar.gz /tmp/
tar -jcvf tmp.tar.bz2 /tmp/
# 解压缩与解打包
tar -zxvf tmp.tar.gz
tar -jxvf tmp.tar.gz

# 只查看，不解压
tar -ztvf tmptar.gz

# 解压到指定位置
tar -zxvf tmp.tar.gz -C /tmp

# 只解压压缩包中的特定文件，到指定位置
tar -zxvf tmp.tar.gz -C /tmp test/cde
```



## 9. 关机和重启

### 1）sync数据同步

【功能描述】：刷新文件系统缓冲区



### 2）shutdown(推荐)

【功能描述】：关机和重启

```
# 基本命令格式
shutdown [选项] 时间 [警告信息]
选项：
   -c：取消已经执行的shutdown命令
   -h：关机
   -r：重启
```



### 3）reboot

在现在的系统中，reboot命令也是安全的，而且不需要加入过多的选项。



### 4）halt和poweroff

这两个都是关机命令，直接执行即可。这两个命令不会完整关闭和保存系统的服务，不建议使用。



### 5）init

init是修改Linux运行级别的命令，也可以用于关机和重启，这个命令并不安全，不建议使用。



## 10. 网络命令

### 1）配置IP地址

a. 配置IP地址

IP地址是计算机在互联网中唯一的地址编码。每台计算机如果需要接入网络和其他计算机进行数据通信，就必须配置唯一的公网IP地址。

配置IP地址方法：

- setup工具
- 手工修改配置文件：vi /etc/sysconfig/network-scripts/ifcfg-eth0



b. 重启网络服务

```shell
# 重启网络服务
service network restart
```



c. 虚拟机需要桥接到有线网卡，并重启网络服务。



d. 复制镜像有可能需要重置UUID（唯一识别符）

```shell
# 删除MAC地址行
vi /etc/sysconfig/network-scripts/ifcfg-eth0

# 删除MAC地址和UUID绑定文件
rm -rf /etc/udev/rules.d/70-persistent-net.rules

# 重启Linux
reboot
```

 

### 2）ifconfig

【功能描述】：配置网络接口

ifconfig命令最主要的作用就是查看IP地址的信息，直接输入ifconfig命令即可。



### 3）ping

【功能描述】：向网络主机发送ICMP请求。

ping是常用的网络命令，主要通过ICMP协议进行网络探测，测试网络中主机的通信情况。

```
# 基本命令格式
ping [选项] IP
选项：
  -b：后面加入广播地址，用于对整个网段进行探测
  -c 次数：用于指定ping的次数
  -s 字节：指定探测包的大小

# 探测192.168.103.0/24网段中有多少可以通信的主机
ping -b -c 3 192.168.103.255
```



### 4）netstat

【功能描述】：输出网络连接、路由表、接口统计、伪装连接和组播成员。

netstat是网络状态查看命令，既可以查看到本机开启的端口，也可以查看有哪些客户端连接。

在CentOS 7.x中netstat命令默认没有安装，如果需要使用，需要安装net-snmp和net-tools软件包。

```
# 基本命令格式
netstat [选项]

选项：
  -a：列出所有网络状态，包括Socket程序
  -c 秒数：指定每隔几秒刷新一次网络状态
  -n：使用IP地址和端口号显示，不使用域名与服务名
  -p：显示PID和程序名
  -t：显示使用TCP协议端口的连接状况
  -u：显示使用UDP协议端口的连接状况
  -l：仅显示监听状态的连接
  -r：显示路由表
  

# 查看本机开启的端口
netstat -tuln
```

命令输出结果：

- Proto：网络连接的协议，一般就是TCP协议或者UDP协议。
- Recv-Q：表示接收到的数据，已经在本地的缓冲中，但是还没有被进程取走。
- Send-Q：表示从本机发送，对方还没有收到的数据，依然在本地的缓冲中，一般是不具备ACK标志的数据包。
- Local Address：本机的IP地址和端口号。
- Foreign Address：远程主机的IP地址和端口号。
- State：状态。常见的状态主要有以下几种。
  - LISTEN：监听状态，只有TCP协议需要监听，而UDP协议不需要监听。
  - ESTABLISHED：已经建立连接的状态。如果使用“-l”选项，则看不到已经建立连接的状态。
  - SYN_SENT：SYN发起包，就是主动发起连接的数据包。
  - SYN_RECV：接收到主动连接的数据包。
  - FIN_WAIT1：正在中断的连接。
  - FIN_WAIT2：已经中断的连接，但是正在等待对方主机进行确认。
  - FIN_WAIT：连接已经中断，但是套接字依然在网络中等待结束。
  - CLOSED：套接字没有被使用。

在这些状态中，我们最用的就是LISTEN和ESTABLISHED状态，一种代表正在监听，另一种代表已经建立连接。



### 5）write

【功能描述】：向其他用户发送信息

```shell
# 查看有多少人正在登录
ben@ben-NBLK-WAX9X:~$ w
 14:50:14 up 4 min,  1 user,  load average: 2.31, 1.29, 0.56
USER     TTY      来自           LOGIN@   IDLE   JCPU   PCPU  WHAT
ben               -                14:46     ?     0.00s  0.04s lightdm --session-child 13 20

# 向在pts/1（远程终端）登录的user1用户发送信息，使用"Ctrl+D"快捷键保存发送的数据
write user1 pts/1
```



### 6）wall

write命令用于给指定用户发送信息，而wall命令用于给所有登录用户发送信息，包括自己。执行时，在wall命令后加入需要发送的信息即可。

```
wall "hello"
```



### 7）mail

mail是Linux的邮件客户端命令，可以利用这个命令给其他用户发送邮件。

【功能描述】：发送和接收电子邮件。



a. 发送邮件

```shell
# 发送邮件, Ctrl+D发送
mail user1
```

接收到的邮件都保存在“/var/spool/mail/用户名”中，每个用户都有一个以自己的用户名命令的邮箱。



b. 发送文件内容

如果想把某个文件的内容发送给指定用户，则可以执行如下命令：

```shell
# 把/root/anaconda-ks.cfg文件内容发送给root用户
mail -s "test mail" root < /root/anaconda-ks.cfg
选项：
  -s：指定邮件标题
```

在写脚本时，有时需要脚本自动发送一些信息给指定用户，把要发送的信息预先写到文件中，是一个非常不错的选择。



c. 查看已经接收的邮件

我们可以直接在命令行中执行mail命令，进入mail的交互命令中，可以在这里查看已经接收到的邮件。

```shell
$ mail
"/var/mail/test": 2 messages 2 new
>N   1 ben                日 12月 22 15:  13/425   hello
 N   2 ben                日 12月 22 15:  15/434   hello
#未阅读 编号 发件人            时间                  标题
```

可以看到已经接收到的邮件列表，“N”代表未读邮件，如果是已经阅读过的邮件，则前面是不会有这个“N”的；之后的数字是邮件的编号，我们主要通过这个编号来进行邮件的操作。如果我们想要查看第一封邮件，则只需要输入邮件的编号“1”就可以了。

交互命令是可以简化输入的。

- headers: 列出邮件标题列表，直接输入“h”命令即可。
- delete：删除指定邮件。比如想要删除第二封邮件，可以输入“d 2”。
- save：保存邮件。可以把指定邮件保存成文件。如"s 2 /tmp/test.mail"。
- quit：退出，并把已经操作过的邮件进行保存。比如移除已删除邮件、保存已阅读邮件等。
- exit：退出，但是不保存任何操作。



### 8）nmap

端口扫描命令。

```
[root@localhost ~]# nmap -sT 域名或IP
选项：
  -s        扫描
  -T        扫描所有开启的TCP端口
```

```shell
[root@localhost ~]# nmap -sT 127.0.0.1
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-01 15:55 CST
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00027s latency).
Not shown: 995 closed tcp ports (conn-refused)
PORT     STATE SERVICE
25/tcp   open  smtp
631/tcp  open  ipp
1090/tcp open  ff-fms
4000/tcp open  remoteanything
9090/tcp open  zeus-admin

Nmap done: 1 IP address (1 host up) scanned in 0.09 seconds
```



## 11. 痕迹命令

系统中有一些重要的痕迹日志文件，如/var/log/wtmp、/var/run/utmp、/var/log/btmp、/var/log/lastlog等日志文件，如果你用vim打开这些文件，你会发现这些文件是二进制乱码。这是由于这些日志中保存的是系统的重要登录痕迹，包括某个用户何时登录了系统，何时退出了系统，错误登录等重要的系统信息。这些信息要是可以通过vim打开，就能编辑，这样痕迹信息就不准确，所以这些重要的痕迹日志，只能通过对应的命令来进行查看。

### 1）w

w命令是显示系统中正在登录的用户信息的命令，这个命令查看的痕迹日志是/var/run/utmp。

【功能描述】：显示登录用户，和他正在做什么。

```shell
root@90ubuntu:~# w
 15:44:22 up  1:59,  1 user,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root     pts/0    192.168.0.75     15:44    3.00s  0.01s  0.00s w
```

第一行信息：

- 系统当前时间
- 系统运行时间
- 当前登录用户数
- 系统在之前1分钟、5分钟、15分钟的平均负载。如果CPU是单核的，则这个数值超过1就是高负载，如果CPU是四核的，则这个数值超过4就是高负载。

第二行信息：

- USER: 当前登录的用户
- TTY: 登录的终端
  - tty1-6：本地字符终端(alt+F1-6切换)
  - tty7：本地图形终端(ctrl+alt+F7切换，必须安装启动图形界面)
  - pts/0-255：远程终端
- FROM：登录的IP地址，如果是本地终端，则是空
- LOGIN@：登录时间
- IDLE：用户闲置时间
- JCPU：所有进程占用的CPU时间
- PCPU：当前进程占用的CPU时间
- WHAT：用户正在进行的操作



### 2）who

who命令和w命令类似，用于查看正在登录的用户，但是显示的内容更加简单，也是查看/var/run/utmp。

```shell
root@90ubuntu:~# who
root     pts/0        2024-12-22 15:44 (192.168.0.75)
#用户名   登录终端      登录时间(来源IP)
```



### 3）last

last命令是查看系统所有登录过的用户的信息的，包括正在登录的用户和之前登录的用户。这个命令查看的是/var/log/wtmp痕迹日志文件。

```shell
root@90ubuntu:~# last
root     pts/0        192.168.0.75     Sun Dec 22 15:44   still logged in
reboot   system boot  5.15.0-117-gener Sun Dec 22 13:45   still running
reboot   system boot  5.15.0-117-gener Sun Dec 22 13:15   still running
reboot   system boot  5.15.0-117-gener Fri Dec 20 15:52   still running
reboot   system boot  5.15.0-117-gener Fri Dec 20 15:44   still running
reboot   system boot  5.15.0-117-gener Thu Dec 19 19:53   still running
# 系统重启信息记录
root     pts/0        192.168.0.75     Thu Dec 19 17:00 - 18:02  (01:02)
#用户名   终端号        来源IP地址        登录时间            退出时间
```



### 4）lastlog

lastlog命令是查看系统中所有用户最后一次的登录时间的命令，他查看的日志是/var/log/lastlog文件。

```shell
root@90ubuntu:~# lastlog
Username         Port     From             Latest
root             pts/0    192.168.0.75     Sun Dec 22 15:44:19 +0800 2024
daemon                                     **Never logged in**     # 系统伪用户
bin                                        **Never logged in**
sys                                        **Never logged in**
sync                                       **Never logged in**
games                                      **Never logged in**
man                                        **Never logged in**
lp                                         **Never logged in**
...
# 用户名         终端       来源IP           登录时间
```



### 5）lastb

lastb命令是查看错误登录的信息的，查看的是/var/log/btmp痕迹日志。。

```shell
root@90ubuntu:~# lastb
root         tty1                        Mon Nov 12 23:50 - 23:58 （00:00）
#错误登录用户  终端                        尝试登录的时间
```





## 12. 挂载命令

### 1）mount

linux所有存储设备都必须挂载使用，包括硬盘。

```
# 查询系统中已经挂载的设备，-l会显示卷标名称
mount -l

# 依据配置文件/etc/fstab的内容，自动挂载
mount -a

mount [-t 文件系统] [-L 卷标名] [-o 特殊选项] 设备文件名 挂载点
选项：
  -t 文件系统：加入文件系统类型来指定挂载的类型，可以ext3、ext4、iso9660等文件系统
  -L 卷标名：挂载指定卷标的分区，而不是安装设备文件名挂载
  -o 特殊选项：可以指定挂载的额外选项，比如读写权限、同步异步等，如果不指定则默认值生效。参数如下表。
```

| 参数          | 说明                                                         |
| ------------- | ------------------------------------------------------------ |
| atime/noatime | 更新访问时间/不更新访问时间，访问时区文件时，是否更新文件的访问时间，默认为更新 |
| async/sync    | 异步/同步，默认为异步                                        |
| auto/noauto   | 自动/手动，mount -a命令执行时，是否会自动安装/etc/fstab文件内容挂载，默认为自动 |
| defaults      | 定义默认值，相当于rw,suid,dev,exec,auto,nouser,async这七个选项 |
| exec /noexec  | 执行/不执行，设定是否允许在文件系统中执行可执行文件，默认是exec允许 |
| remount       | 重新挂载已经挂载的文件系统，一般用于指定修改特殊权限         |
| rw/ro         | 读写/只读，文件系统挂载时，是否具有读写权限，默认是w         |
| suid/nosuid   | 具有/不具有SUID权限，设定文件系统是否具有SUID和SGID的权限，默认是具有 |
| user/nouser   | 允许/不允许普通用户挂载，设定文件系统是否允许普通用户挂载，默认是不允许，只有root挂载分区 |
| usrquota      | 写入代表文件系统支持用户磁盘配额，默认不支持                 |
| grpquota      | 写入代表文件系统支持组磁盘配额，默认不支持                   |



### 2）挂载光盘

光盘挂载的前提依然是指定光盘的设备文件名，不同版本的Linux，设备文件名并不相同。

- CentOS 5.x以前的系统，光盘设备文件名是/dev/hdc。
- CentOS 6.x以后的系统，光盘设备文件名是/dev/sr0。

不论哪个系统都有软链接/dev/cdrom，都可以作为光盘的设备文件名。

```shell
# 挂载光盘
mount -t iso9660 /dev/cdrom /mnt/cdrom/

# 卸载
umount /mnt/cdrom 或 umount /dev/sr0
```

【注意】：卸载的时候需要退出光盘目录，才能正常卸载。



### 3）挂载U盘

U盘会和硬盘共用设备文件名，所以U盘的设备文件名不是固定的，需要手工查询。

```shell
# 查询硬盘
fdisk -l

# 挂载
mount -t vfat /dev/sdb1 /mnt/usb/
```

如果U盘中有中文，会发现中文是乱码，Linux要想正常显示中文，需要两个条件：

- 安装了中文编码和中文字体。
- 操作终端需要支持中文显示(纯字符终端，是不支持中文编码的)。

```shell
# 挂载U盘，指定中文编码格式为UTF-8
mount -t vfat -o iocharset=utf8 /dev/sdb1 /mnt/usb/

# 卸载
umount /mnt/usb/
```



### 4）挂载NTFS分区

Linux的驱动加载顺序：

- 驱动直接放入系统内核之中，这种驱动主要是系统启动加载必须的驱动，数量较少。
- 驱动以模块的形式放入硬盘。大多数驱动都以这种方式保存，保存位置在/lib/modules/3.10.0-862.el7.x86_64/kernel/中。
- 驱动可以被Linux识别，但是系统认为这种驱动一般不常用，默认不加载。如果需要加载这种驱动，需要重新编译内核，而NTFS文件系统的驱动就属于这种情况。
- 硬件不能被Linux内核识别，需要手工安装驱动。当然前提是厂商提供了该硬件针对Linux的驱动，否则需要自己开发驱动了。



使用NTFS-3G安装NTFS文件系统模块

下载NTFS-3G插件：https://github.com/tuxera/ntfs-3g

安装完成后，就可以挂载和使用Windows的NTFS分区了：

```shell
mount -t ntfs-3g /dev/sdb1 /mnt/win
```




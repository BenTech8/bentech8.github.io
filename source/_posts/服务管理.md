---
title: 服务管理
date: 2025-03-05 15:31:39
tags:
categories: Linux
---

## 服务的简介与分类

### 服务的分类

Linux服务：

- RPM包默认安装的服务

  - 独立的服务

    就是独立启动的意思，这类型的服务可以自行启动，而不用依赖其他的管理服务。不依赖其他管理服务，那么当客户端请求访问时，独立的服务响应请求更迅速。Linux中目前大多数服务都是独立的服务，比如apache服务，FTP服务，Samba服务等。

  - 基于xinetd服务

    这种服务就不能独立启动了，而是要依靠管理服务来调用这种服务。这个负责管理的服务就是xinetd服务，xinetd服务是系统的超级守护进程。xinetd服务的作用就是管理不能独立启动的服务，当有客户端请求时，先请求xinetd服务，由xinetd服务云唤醒相对应的服务。当客户端请求结束后，被唤醒的服务会关闭并释放资源。这样做的好处是只需要持续启动xinetd服务，而其他基于xinetd的服务只有在需要时才启动，不会占用过多的服务器资源。但是这种服务由于在有客户端靖求时才会被唤醒，所以响应时间相对较慢。

- 源码包安装的服务

  

### 查询已经安装的服务

```shell
[root@localhost ~]# chkconfig --list [服务名]
选项：
  --list: 列出所有RPM默认安装服务的自启动状态
```



## RPM包默认安装的服务管理

### 独立服务管理

#### 独立服务的启动管理

- 使用/etc/init.d/目录中的启动脚本启动服务

  ```shell
  [root@localhost ~]# /etc/init.d/httpd start
  ```

- 使用service命令来启动独立的服务

  ```shell
  [root@localhost ~]# service [独立服务名] start|stop|restart|...
  ```

  

#### 独立服务的自启动管理

- 使用chkconfig服务自启动管理命令

  ```shell
  [root@localhost ~]# chkconfig [--level 运行级别] [独立服务名] [on|off]
  选项：
    --level:    设定在哪个运行级别中开机自启动(on)，或是关闭自启动(off)
  ```

  ```shell
  [root@localhost ~]# chkconfig --level 2345 httpd on
  ```

- 修改/etc/rc.d/rc.local文件，设置服务自启动

  ```shell
  [root@localhost ~]# vim /etc/rc.d/rc.local
  #!/bin/bash
  #
  # This script will be executed *after* all the other init scripts.
  # You can put your own initialization stuff in here if you don't
  # want to do the full Sys V style init stuff.
  
  touch /var/lock/subsys/local
  /etc/rc.d/init.d/httpd start
  ```

- 使用ntsysv命令管理自启动

  ```
  [root@localhost ~]# ntsysv [--level 运行级别]
  选项：
    --level 运行级别:  可以指定设定自启动的运行级别
  ```

  这个命令的操作是这样的：

  - 上下键：在不同服务之间移动
  - 空格键：选定或取消服务的自启动，就是在服务之前是否打入“*”
  - tab键：在不同项目间切换
  - F1键：显示服务的说明

  

### 基于xinetd服务的管理

#### 基于xinetd服务的启动

以telnet服务为例，telnet服务是用来进行系统远程管理的，端口是23。不过需要注意的是telnet的远程管理数据在网络中是明文传输，非常不安全。在生产服务器上不建议启动telnet服务。在生产服务器上，远程管理使用的是ssh协议，ssh是加密的，更加安全。

```shell
[root@localhost ~]# vim /etc/xinetd.d/telnet
# default: on
# description: The telnet server serves telnet sessions: it uses \
#       unencrypted username/password pairs for authentication.
service telnet                                     # 服务的名称为telnet
{
	flags				= REUSE                    # 标志为REUSE，设定TCP/IP socket可重用
	socket_type         = stream                   # 使用TCP协议数据包
	wait				= no					   # 允许多个连接同时连接
	user				= root					   # 启动服务的用户为root
	server				= /usr/sbin/in.telnetd     # 服务的启动程序
	log_on_failure		+= USERID                  # 登录失败后，记录用户的ID
	disable				= yes					   # 服务不启动
}
```

```shell
[root@localhost ~]# vim /etc/xinetd.d/telnet
service telnet
{
	...
	disable				= no
}

[root@localhost ~]# service xinetd restart
```



#### 基于xinetd服务的自启动

- 使用chkconfig命令管理自启动

- 使用ntsysv命令管理自启动

  ```
  [root@localhost ~]# chkconfig 服务名 on|off
  ```

  

## 源码包安装的服务管理

### 源码包服务的启动管理

```shell
[root@localhost ~]# /usr/local/apache2/bin/apachectl start|stop|restart|...
```



### 源码包服务的自启动管理

```shell
[root@localhost ~]# vim /etc/rc.d/rc.local
#!/bin/bash
#
# This script will be executed *after* all the other init scripts.
# You can put your own initialization stuff in here if you don't
# want to do the full Sys V style init stuff.

touch /var/lock/subsys/local
/usr/local/apache2/bin/apachectl start
```



## Linux中常见服务的作用

| 服务名称        | 功能简介                                                     | 建议 |
| --------------- | ------------------------------------------------------------ | ---- |
| acpid           | 电源管理接口。如果是笔记本用户建立开启，可以监听内核层的相关电源事件 | on   |
| anacron         | 系统的定时任务程序。cron的一个子系统，如果定时任务错过了执行时间，可以通过anacron继续唤醒执行。 | off  |
| alsasound       | Alsa声卡驱动。如果使用alsa声卡，开启                         | off  |
| apmd            | 电源管理模块。如果支持acpid，就不需要apmd，可以关闭          | off  |
| atd             | 指定系统在特定时间执行某个任务，只能执行一次。如果需要则开启，但我们一般使用crond来进行循环定时任务。 | off  |
| auditd          | 审核子系统。如果开启了此服务，SELinux的审核信息会写入/var/log/audit/audit.log文件，如果不开启，审核信息会记录在syslog中 | on   |
| autofs          | 让服务器可以自动挂载网络中的其他服务器的共享数据，一般用来自动挂载NFS服务。如果没有NFS服务建立关闭 | off  |
| avahi-daemon    | Avahi是zeroconf协议的实现。它可以在没有DNS服务的局域网里发现基于zeroconf协议的设备和服务。除非有兼容设备或使用zeroconf协议，否则关闭 | off  |
| bluetooth       | 蓝牙设备支持。一般不会在服务器上启用蓝牙设备。               | off  |
| capi            | 仅对使用ISND设备的用户有用。                                 | off  |
| chargen-dgram   | 使用UDP协议的chargen server。主要功能是提供类似远程打字的功能。 | off  |
| chargen-stream  | 同上                                                         | off  |
| cpuspeed        | 可以用来调整CPU的频率。当闲置时可以自动降低CPU频率来节省电量 | on   |
| crond           | 系统的定时任务，一般的Linux服务器都需要定时任务帮助系统维护  | on   |
| cvs             | 一个版本控制系统                                             | off  |
| daytime-dgram   | daytime使用TCP协议的Daytime守护进程，该协议为客户机实现从远程服务器获取日期和时间的功能。 | off  |
| daytime-stream  | 同上                                                         | off  |
| dovecot         | 邮件服务中POP3/IMAP服务的守护进程。主要用来接收信件，如果启动了邮件服务则开启，否则关闭 | off  |
| echo-dgram      | 服务器回显客户服务的进程。                                   | off  |
| echo-stream     | 同上。                                                       | off  |
| firstboot       | 系统安装完成之后，有个欢迎界面，需要对系统进程初始设定，就是这个进程的作用。既然不是第一次启动，可以关闭 | off  |
| gpm             | 在字符终端(tty1-tty6)中可以使用鼠标复制和粘贴。就是这个服务的功能。 | on   |
| haldaemon       | 检测盒支持USB设备。如果是服务器可以关闭，个人建议关闭        | off  |
| hidd            | 蓝牙鼠标、键盘等蓝牙设备检测。必须启动bluetooth服务。        | off  |
| hplip           | HP打印机支持，如果没有HP打印机则关闭                         | off  |
| httpd           | apache服务的守护进程。如果需要启动apache，则开启             | on   |
| ip6tables       | IPv6防火墙，目前IPv6协议并没有使用，可以关闭                 | off  |
| iptables        | 防火墙功能，Linux中防火墙是内核支持功能，这是服务器的主要防护手段，必须开启 | on   |
| irda            | IrDA提供红外线设备(笔记本、PDA's，手机，计算器等等)间的通讯支持。 | off  |
| irqbalance      | 支持多核处理器，让CPU可以自动分配系统中断(IRQ)，提高系统性能。 | on   |
| isdn            | 使用ISDN设备连接网络。目前主流的联网方式是光纤接入和ADSL，ISDN已经非常少见 | off  |
| kudzu           | 该服务可以在开机时进行硬件检测，并会调用相关的设置软件。     | off  |
| lvm2-monitor    | 该服务可以让系统支持LVM逻辑卷组，如果分区采用的是LVM方式，那么应该开启 | on   |
| mcstrans        | SELinux的支持服务                                            | on   |
| mdmonitor       | 该服务用来监测Software RAID或LVM的信息。不是必须服务         | off  |
| mdmpd           | 该服务用来监测Multi-Path设备                                 | off  |
| messagebus      | 这是Linuxr IPC（Interprocess Communication, 进程间通讯）服务，用来在各个软件中交换信息 | off  |
| microcode_ctl   | Intel系列的CPU可以通过这个服务支持额外的微指令集。           | off  |
| mysqld          | mysql数据库服务器。如果需要就开启，                          | off  |
| named           | DNS服务的守护进程，用来进行域名解析。如果是DNS服务器则开启   | off  |
| netfs           | 该服务用于在系统启动时自动挂载网络中的共享文件空间，比如：NFS, Samba等。需要则开启 | off  |
| network         | 提供网络设置功能。通过这个服务来管理网络                     | on   |
| nfs             | NFS（Network File System）服务，Linux与Linux之间的文件共享服务。需要就开启 | off  |
| nfslock         | 在Linux中如果使用了NFS服务，为了避免同一个文件被不同的用户编辑，所以有了这个锁服务。有NFS是开启 | off  |
| ntpd            | 该服务可以通过互联网自动更新系统时间，使系统时间永远都准确。需要则开启 | off  |
| pcscd           | 智能卡检测服务                                               | off  |
| portmap         | 用在远程过程调用（RPC）的服务，如果没有任何RPC服务时，可以关闭，主要是NFS和NIS服务需要 | off  |
| psacct          | 该守护进程支持几个监控进程活动的工具。                       | off  |
| rdisc           | 客户端ICMP路由协议                                           | off  |
| readahead_early | 在系统开机的时候，先将某些进程加载如内存整理，可以加快一点启动速度。 | off  |
| readahead_later | 同上                                                         | off  |
| restorecond     | 用于给SELinux监测和重新加载正确的文件上下文。如果开启SELinux则需要开启。 | off  |
| rpcgssd         | 与NFS有关的客户端功能                                        | off  |
| rpcidmapd       | 同上                                                         | off  |
| rsync           | 远程数据备份守护进程                                         | off  |
| sendmail        | sendmail邮件服务的守护进程。如果有邮件服务就开启             | off  |
| setroubleshoot  | 该服务用于将SELinux相关信息记录在日志/var/log/messages中     | on   |
| smartd          | 该服务用于自动检则硬盘状态                                   | on   |
| smb             | 网络服务samba守护进程。可以让Linux和Windows之间共享数据。如果需要则开启 | off  |
| squid           | 代理服务的守护进程。                                         | off  |
| sshd            | ssh加密远程登录管理的服务。                                  | on   |
| syslog          | 日志的守护进程。                                             | on   |
| vsftpd          | vsftpd服务的守护进程。如果需要FTP服务则开启                  | off  |
| xfs             | 这个是X Window的字体守护进程。为图形界面提供字体服务，如果不启动图形界面就不用开启 | off  |
| xinetd          | 超级守护进程。如果有依赖xinetd的服务就必须开启               | off  |
| ypbind          | 为NIS(网络信息系统)客户机激活ypbind服务进程。                | off  |
| yum-updatesd    | yum的在线升级服务                                            | off  |

